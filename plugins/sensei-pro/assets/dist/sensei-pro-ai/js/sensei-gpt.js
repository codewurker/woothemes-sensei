(()=>{var e={7316:(e,t)=>{var n;!function(){"use strict";var s={}.hasOwnProperty;function r(){for(var e="",t=0;t<arguments.length;t++){var n=arguments[t];n&&(e=l(e,o(n)))}return e}function o(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return r.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var n in e)s.call(e,n)&&e[n]&&(t=l(t,n));return t}function l(e,t){return t?e?e+" "+t:e+t:e}e.exports?(r.default=r,e.exports=r):void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n)}()}},t={};function n(s){var r=t[s];if(void 0!==r)return r.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.wp.element,t=window.wp.components,s=window.wp.compose,r=window.wp.i18n,o=window.wp.hooks,l=window.React;var a;function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},i.apply(this,arguments)}function c(e){return l.createElement("svg",i({width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),a||(a=l.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.5 9.25a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0zM10 13.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zm4.75 3a.75.75 0 100-1.5.75.75 0 000 1.5z",fill:"#00594F"})))}const u=window.wp.data,m=e=>{let t="";return e.forEach((e=>{let n=p(e);n=n?n+" ":"",e.innerBlocks&&e.innerBlocks.length>0&&(n+=m(e.innerBlocks)),t+=n})),t},p=e=>{const{attributes:t,name:n}=e;switch(n){case"core/paragraph":case"core/verse":case"core/preformatted":case"core/code":case"core/heading":case"core/freeform":case"core/list-item":return t.content;case"core/pullquote":return'"'+t.value+'" said '+t.citation+".";default:return""}},d=window.wp.apiFetch;var _=n.n(d);const h=window.wp.blocks,g=window.wp.blockEditor;function b(){return b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},b.apply(this,arguments)}const w=t=>(0,s.createHigherOrderComponent)((n=>s=>(((t,n)=>{let{attributes:s,setMeta:r}=n;(0,e.useEffect)((()=>{const e=v(t(s));r({validationErrors:e})}),[t,s,r])})(t,s),(0,e.createElement)(n,s))),"withBlockValidation"),v=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.entries(e).filter((e=>{let[,t]=e;return t})).map((e=>{let[t]=e;return t}))};var k=n(7316),f=n.n(k);const E=(0,e.createContext)({}),y={correct:{title:(0,r.__)("Correct","sensei-pro"),placeholder:(0,r.__)("Show a message when the question is answered correctly. Type / to choose a block.","sensei-pro")},incorrect:{title:(0,r.__)("Incorrect","sensei-pro"),placeholder:(0,r.__)("Show a message when the question is answered incorrectly. Type / to choose a block.","sensei-pro")}},q=t=>{let{type:n}=t;const{title:s,placeholder:r}=y[n],o=(0,e.useContext)(E),{hideAnswerFeedback:l}=o.options;return l?"":(0,e.createElement)("div",{className:f()("sensei-lms-question__answer-feedback",`sensei-lms-question__answer-feedback--${n}`)},(0,e.createElement)("div",{className:"sensei-lms-question__answer-feedback__header"},(0,e.createElement)("span",{className:"sensei-lms-question__answer-feedback__icon"}),(0,e.createElement)("span",null,s)),(0,e.createElement)("div",{className:"sensei-lms-question__answer-feedback__content"},(0,e.createElement)(g.InnerBlocks,{template:[["core/paragraph",{placeholder:r}]],templateInsertUpdatesSelection:!1,templateLock:!1})))};var N,C;function B(){return B=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},B.apply(this,arguments)}const x=function(e){return l.createElement("svg",B({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},e),N||(N=l.createElement("path",{d:"M12.408 7.277A2.999 2.999 0 009 10.25h1.5c0-.677.375-1.14.886-1.37.512-.228 1.11-.198 1.614.253.504.45.6 1.04.43 1.574-.171.534-.592.958-1.264 1.033l.021-.002a1.034 1.034 0 00-.937.99V14h1.5v-.95c1.02-.28 1.817-.979 2.107-1.888a2.998 2.998 0 00-2.449-3.885z"})),C||(C=l.createElement("path",{d:"M6 4c-1.096 0-2 .904-2 2v12c0 1.096.904 2 2 2h12c1.096 0 2-.904 2-2V6c0-1.096-.904-2-2-2H6zm0 1.5h12c.284 0 .5.216.5.5v12a.49.49 0 01-.5.5H6a.49.49 0 01-.5-.5V6c0-.284.216-.5.5-.5zm5.25 9.5v1.5h1.5V15h-1.5z"})))},A={parent:["sensei-lms/quiz-question"],category:"sensei-lms",supports:{html:!1},attributes:{id:{type:"integer"}}},S={...A,name:"sensei-lms/quiz-question-feedback-correct",title:(0,r.__)("Correct Answer Feedback","sensei-pro"),icon:x,description:(0,r.__)("Display correct answer feedback.","sensei-pro"),edit:e=>q({...e,type:"correct"}),save:()=>(0,e.createElement)(g.InnerBlocks.Content,null)},P={...A,name:"sensei-lms/quiz-question-feedback-incorrect",title:(0,r.__)("Incorrect Answer Feedback","sensei-pro"),icon:x,description:(0,r.__)("Display incorrect answer feedback.","sensei-pro"),edit:e=>q({...e,type:"incorrect"}),save:()=>(0,e.createElement)(g.InnerBlocks.Content,null)},T=window.lodash;var F={};function O(e){return[e]}function z(e,t,n){var s;if(e.length!==t.length)return!1;for(s=n;s<e.length;s++)if(e[s]!==t[s])return!1;return!0}window.senseiStores=window.senseiStores||[];const{senseiStores:I}=window,M={reducer:(R={SET_BLOCK_META:(e,t)=>{let{clientId:n,metadata:s}=e;return{...t,[n]:{...t[n]||{},...s}}},CLEAR:(e,t)=>t?{...e,[t]:void 0}:{},DEFAULT:e=>e},V={},function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;return(R[t.type]||R.DEFAULT)(t,e)}),actions:{setBlockMeta:(e,t)=>({type:"SET_BLOCK_META",clientId:e,metadata:t}),clear:function(){return{type:"CLEAR",clientId:arguments.length>0&&void 0!==arguments[0]?arguments[0]:null}}},selectors:{getBlockMeta:function(e,t){var n;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return s?null===(n=e[t])||void 0===n?void 0:n[s]:e[t]},getMultipleBlockMeta:function(e,t){var n,s=(e=>[e])||O;function r(){n=new WeakMap}function o(){var t,r,o,l,a,i=arguments.length;for(l=new Array(i),o=0;o<i;o++)l[o]=arguments[o];for(t=function(e){var t,s,r,o,l,a=n,i=!0;for(t=0;t<e.length;t++){if(!(l=s=e[t])||"object"!=typeof l){i=!1;break}a.has(s)?a=a.get(s):(r=new WeakMap,a.set(s,r),a=r)}return a.has(F)||((o=function(){var e={clear:function(){e.head=null}};return e}()).isUniqueByDependants=i,a.set(F,o)),a.get(F)}(a=s.apply(null,l)),t.isUniqueByDependants||(t.lastDependants&&!z(a,t.lastDependants,0)&&t.clear(),t.lastDependants=a),r=t.head;r;){if(z(r.args,l,1))return r!==t.head&&(r.prev.next=r.next,r.next&&(r.next.prev=r.prev),r.next=t.head,r.prev=null,t.head.prev=r,t.head=r),r.val;r=r.next}return r={val:e.apply(null,l)},l[0]=null,r.args=l,t.head&&(t.head.prev=r,r.next=t.head),t.head=r,r.val}return o.getDependants=s,o.clear=r,r(),o}((function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const s=null!=t&&t.length?(0,T.pick)(e,t):e;return n?(0,T.mapValues)(s,n):s}))}};var R,V;const j=((e,t)=>{if(I[e])return I[e];const n=(0,u.createReduxStore)(e,t);return(0,u.register)(n),I[e]=n,n})("sensei/block-metadata",M),D=(0,e.createContext)({}),Q=t=>{const n=(0,u.useSelect)((e=>e(j).getBlockMeta(t)),[t]),{setBlockMeta:s}=(0,u.useDispatch)(j),r=L(),o=(0,e.useCallback)((e=>s(t,e)),[t,s]);return[(0,e.useMemo)((()=>({...r,...n})),[n,r]),o]},L=((0,s.createHigherOrderComponent)((t=>G((n=>{const[s]=Q(n.clientId);return(0,e.createElement)(D.Provider,{value:s},(0,e.createElement)(t,n))}))),"withBlockMetaProvider"),()=>(0,e.useContext)(D)),G=(0,s.createHigherOrderComponent)((t=>n=>{const[s,r]=Q(n.clientId);return(0,e.createElement)(t,b({},n,{meta:s,setMeta:r}))}),"withBlockMeta"),W=(0,s.compose)(G)((()=>{const t=(0,g.useBlockProps)({className:"sensei-lms-question-description-block"});return(0,e.createElement)("div",t,(0,e.createElement)(g.InnerBlocks,{template:[["core/paragraph",{placeholder:(0,r.__)("Add question description or type / to choose a block.","sensei-pro")}]],templateInsertUpdatesSelection:!1,templateLock:!1}))})),H=JSON.parse('{"name":"sensei-lms/question-description","apiVersion":2,"title":"Description","description":"Question Description.","parent":["sensei-lms/quiz-question"],"category":"sensei-lms","textdomain":"sensei-lms","supports":{"html":false},"attributes":{"id":{"type":"integer"}}}'),U={...H,metadata:H,icon:x,usesContext:["sensei-lms/quizId"],edit:W,save:()=>(0,e.createElement)(g.InnerBlocks.Content,null)},K=(0,e.forwardRef)((function({icon:t,size:n=24,...s},r){return(0,e.cloneElement)(t,{width:n,height:n,...s,ref:r})})),J=window.wp.primitives,$=(0,l.createElement)(J.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,l.createElement)(J.Path,{d:"M6.5 12.4L12 8l5.5 4.4-.9 1.2L12 10l-4.5 3.6-1-1.2z"})),X=(0,l.createElement)(J.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},(0,l.createElement)(J.Path,{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"})),Y=()=>{const{answerFeedback:{showAnswerFeedback:t,toggleAnswerFeedback:n},options:{hideAnswerFeedback:s}}=(0,e.useContext)(E);return s?"":(0,e.createElement)("div",{className:f()("sensei-lms-question-block__answer-feedback-toggle",{"is-visible":t})},(0,e.createElement)("button",{className:"sensei-lms-question-block__answer-feedback-toggle__header",onClick:()=>n(!t)},(0,r.__)("Answer Feedback","sensei-pro"),(0,e.createElement)(K,{className:"sensei-lms-question-block__answer-feedback-toggle__icon",icon:t?$:X})),(0,e.createElement)("div",{className:"sensei-lms-question-block__answer-feedback-toggle__help"},(0,r.__)("Show feedback once the question is answered.","sensei-pro")))},Z=JSON.parse('{"name":"sensei-lms/question-answers","apiVersion":2,"title":"Answers","description":"Question Answers.","parent":["sensei-lms/quiz-question"],"category":"sensei-lms","textdomain":"sensei-lms","supports":{"html":false},"attributes":{}}'),ee={...Z,metadata:Z,icon:x,edit:()=>{const{answer:t,setAttributes:n,AnswerBlock:s,hasSelected:r,canHaveFeedback:o}=(0,e.useContext)(E),l=(0,g.useBlockProps)({className:"sensei-lms-question-answers-block"});return(0,e.createElement)("div",l,(null==s?void 0:s.edit)&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(s.edit,{attributes:t,setAttributes:e=>n({answer:{...t,...e}}),hasSelected:r}),o&&r&&(0,e.createElement)(Y,null)))},save:()=>(0,e.createElement)(g.InnerBlocks.Content,null)},te=e=>{const t=(0,u.useSelect)((t=>{const n=t("core/block-editor"),s=n.getBlockRootClientId(e);return(n.getBlocks(s)||[]).slice(0,n.getBlockIndex(e,s))}),[e]),n=t.reduce(((e,t)=>{var n;return e+("category-question"===t.attributes.type&&(null===(n=t.attributes.options)||void 0===n?void 0:n.number)||1)}),0);return n+1},ne=window.wp.keycodes,se=(0,e.forwardRef)(((t,n)=>{let{onChange:s,onKeyDown:r,value:o,onEnter:l,onRemove:a,...i}=t;return(0,e.createElement)(g.PlainText,b({ref:n,value:o,onChange:e=>{s(e.replace(/\n/g,""))},onKeyDown:e=>{switch(r&&r(e),e.keyCode){case ne.ENTER:e.preventDefault(),l&&l(e);break;case ne.BACKSPACE:!a||null!=o&&o.length||(e.preventDefault(),a())}}},i,{className:f()("sensei-lms-single-line-input",i.className)}))})),re=se,oe=t=>{let{onMount:n}=t;return(0,e.useEffect)((()=>{n()}),[n]),null},le=()=>(0,e.createElement)("div",{className:"wp-block-button is-style-outline sensei-lms-question-block__answer sensei-lms-question-block__answer--file-upload"},(0,e.createElement)("div",{className:"wp-block-button__link wp-element-button"},(0,r.__)("Choose File","sensei-pro"))),ae=n=>{let{attributes:{before:s,after:o,gap:l},setAttributes:a,hasSelected:i}=n;return(0,e.createElement)("ul",{className:"sensei-lms-question-block__answer sensei-lms-question-block__answer--gap-fill"},(0,e.createElement)("li",null,(0,e.createElement)(se,{className:"sensei-lms-question-block__answer--gap-fill__text",placeholder:(0,r.__)("Text before the gap","sensei-pro"),value:s,onChange:e=>a({before:e})})),(0,e.createElement)("li",{className:"sensei-lms-question-block__answer--gap-fill__right-answers",onBlur:e=>{let{target:t}=e;null!=t&&t.value&&(a({gap:[...null!=l?l:[],t.value]}),ce(t,""))}},(0,e.createElement)(t.FormTokenField,{className:"sensei-lms-question-block__text-input-placeholder",value:l||[],label:!1,onChange:e=>a({gap:e})}),i&&(0,e.createElement)("div",{className:"sensei-lms-question-block__answer--gap-fill__hint"},(0,r.__)("Add right answers. Separate with commas or the Enter key.","sensei-pro"))),(0,e.createElement)("li",null,(0,e.createElement)(se,{className:"sensei-lms-question-block__answer--gap-fill__text",placeholder:(0,r.__)("Text after the gap","sensei-pro"),value:o,onChange:e=>a({after:e})})))};ae.view=t=>{let{attributes:{before:n,after:s,gap:r}}=t;return(0,e.createElement)("ul",{className:"sensei-lms-question-block__answer sensei-lms-question-block__answer--gap-fill"},(0,e.createElement)("li",null,n),(0,e.createElement)("li",{className:"sensei-lms-question-block__answer--gap-fill__right-answers sensei-lms-question-block__text-input-placeholder"},r.map((t=>(0,e.createElement)("span",{key:t,className:"sensei-lms-question-block__answer--gap-fill__token"},t)))),(0,e.createElement)("li",null,s))};const ie=ae,ce=(e,t)=>{delete e.value,e.value=t,e.dispatchEvent(new window.Event("change",{bubbles:!0}))},ue=()=>(0,e.createElement)("div",{className:"sensei-lms-question-block__answer sensei-lms-question-block__answer--multi-line"},(0,e.createElement)("div",{className:"sensei-lms-question-block__text-input-placeholder multi-line"})),me=(0,l.createElement)(J.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,l.createElement)(J.Path,{d:"M16.7 7.1l-6.3 8.5-3.3-2.5-.9 1.2 4.5 3.4L17.9 8z"})),pe=t=>{let{className:n,isChecked:s,isCheckbox:r,input:o,children:l,...a}=t;return(0,e.createElement)("div",b({className:f()("sensei-lms-question-block__option-toggle",n)},a),o,(0,e.createElement)("div",{className:f()("sensei-lms-question-block__option-toggle__control",{"is-checked":s,"is-checkbox":r})},r&&me),l)},de=n=>{const{attributes:{label:s,correct:o},setAttributes:l,hasFocus:a,hasSelected:i,isCheckbox:c,...u}=n,m=(0,e.useRef)(null);return(0,e.useEffect)((()=>{if(a){var e;const t=(null===(e=m.current)||void 0===e?void 0:e.textarea)||m.current;null==t||t.focus()}}),[a,m]),(0,e.createElement)("div",{className:"sensei-lms-question-block__multiple-choice-answer-option"},(0,e.createElement)(pe,{isChecked:o,isCheckbox:c}),(0,e.createElement)(re,b({ref:m,placeholder:(0,r.__)("Add Answer","sensei-pro"),className:"sensei-lms-question-block__multiple-choice-answer-option__input",onChange:e=>l({label:e}),value:s},u)),i&&(0,e.createElement)("div",{className:"sensei-lms-question-block__answer--multiple-choice__toggle__wrapper"},(0,e.createElement)(t.Button,{isPrimary:!0,className:"sensei-lms-question-block__answer--multiple-choice__toggle",onClick:()=>l({correct:!o})},o&&(0,r.__)("Right","sensei-pro"),!o&&(0,r.__)("Wrong","sensei-pro"))))},_e=[{label:"",correct:!0},{label:"",correct:!1}],he=e=>e.filter((e=>e.correct)).length>1,ge=t=>{var n;const{setAttributes:s,hasSelected:r}=t;let{attributes:{answers:o=[]}}=t;0===o.length&&(o=_e);const l=he(o),a=!(null!==(n=o[o.length-1])&&void 0!==n&&n.label),i=[...o];r&&!a&&i.push({label:"",correct:!1});const[c,u]=(0,e.useState)(null);return(0,e.createElement)(ge.Options,{answers:i},((t,n)=>(0,e.createElement)(de,{hasFocus:n===c,isCheckbox:l,attributes:t,setAttributes:e=>((e,t)=>{{const n=[...o];n[e]={...n[e],...t},s({answers:n})}})(n,e),onEnter:()=>(e=>{const t=[...o];t.splice(e+1,0,{label:"",correct:!1}),s({answers:t}),u(e+1)})(n),onRemove:()=>(e=>{if(1===o.length)return;u(e-1);const t=[...o];t.splice(e,1),s({answers:t})})(n),hasSelected:r})))};ge.Options=t=>{let{answers:n,children:s}=t;return(0,e.createElement)("ol",{className:"sensei-lms-question-block__answer sensei-lms-question-block__answer--multiple-choice"},n.map(((t,n)=>(0,e.createElement)("li",{key:n,className:f()("sensei-lms-question-block__answer--multiple-choice__option",{"is-draft":!t.label})},s(t,n)))))},ge.view=t=>{let{attributes:{answers:n=[]}}=t;const s=he(n);return(0,e.createElement)(ge.Options,{answers:n},(t=>(0,e.createElement)(e.Fragment,null,(0,e.createElement)(pe,{isChecked:t.correct,isCheckbox:s}),t.label)))};const be=ge,we=t=>{let{children:n}=t;return(0,e.createElement)("div",{className:"sensei-lms-question-block__answer sensei-lms-question-block__answer--single-line"},(0,e.createElement)("small",{className:"sensei-lms-question-block__input-label"},(0,r.__)("Answer:","sensei-pro")),(0,e.createElement)("div",{className:"sensei-lms-question-block__text-input-placeholder"},n))},ve=n=>{let{attributes:{correct:s=!0},setAttributes:o,hasSelected:l}=n;const a=[{label:(0,r.__)("True","sensei-pro"),value:!0},{label:(0,r.__)("False","sensei-pro"),value:!1}];return(0,e.createElement)("ul",{className:"sensei-lms-question-block__answer sensei-lms-question-block__answer--true-false"},a.map((n=>{let{label:a,value:i}=n;return(0,e.createElement)("li",{key:i,className:"sensei-lms-question-block__answer--true-false__option"},(0,e.createElement)(pe,{isChecked:s===i},(0,e.createElement)("span",null,a)),l&&(0,e.createElement)("div",{className:"sensei-lms-question-block__answer--multiple-choice__toggle__wrapper"},(0,e.createElement)(t.Button,{isPrimary:!0,className:"sensei-lms-question-block__answer--true-false__toggle",onClick:()=>o({correct:i===s?!i:i})},s===i&&(0,r.__)("Right","sensei-pro"),s!==i&&(0,r.__)("Wrong","sensei-pro"))))})))};ve.view=t=>{let{attributes:{correct:n=!0}}=t;const s=[{label:(0,r.__)("True","sensei-pro"),value:!0},{label:(0,r.__)("False","sensei-pro"),value:!1}];return(0,e.createElement)("ul",{className:"sensei-lms-question-block__answer sensei-lms-question-block__answer--true-false"},s.map((t=>{let{label:s,value:r}=t;return(0,e.createElement)("li",{key:r,className:"sensei-lms-question-block__answer--true-false__option"},(0,e.createElement)(pe,{isChecked:n===r},(0,e.createElement)("span",null,s)))})))};const ke=ve,fe=n=>{let{options:{teacherNotes:s},setOptions:o}=n;return(0,e.createElement)(t.TextareaControl,{label:(0,r.__)("Grading Notes","sensei-pro"),onChange:e=>o({teacherNotes:e}),value:s||"",help:(0,r.__)("Displayed to the teacher when grading the question.","sensei-pro")})};var Ee="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),ye=new Uint8Array(16);function qe(){if(!Ee)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ee(ye)}for(var Ne=[],Ce=0;Ce<256;++Ce)Ne[Ce]=(Ce+256).toString(16).substr(1);const Be=function(e,t,n){var s=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var r=(e=e||{}).random||(e.rng||qe)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t)for(var o=0;o<16;++o)t[s+o]=r[o];return t||function(e,t){var n=t||0,s=Ne;return[s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],"-",s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]],s[e[n++]]].join("")}(r)},xe=n=>{let{className:s,id:o,label:l,value:a,help:i,allowReset:c=!1,resetLabel:u,onChange:m,suffix:p,hideLabelFromVision:d,..._}=n;return(0,e.createElement)(t.BaseControl,{id:o,label:l,help:i,hideLabelFromVision:d},(0,e.createElement)("div",{className:"sensei-number-control"},(0,e.createElement)("div",{className:"sensei-number-control__input-container"},(0,e.createElement)("input",b({className:f()("sensei-number-control__input components-text-control__input",s),type:"number",id:o,onChange:e=>{m(parseInt(e.target.value,10)||_.min||0)},value:null===a?"":a},_)),p&&(0,e.createElement)("span",{className:"sensei-number-control__input-suffix"},p)),c&&(0,e.createElement)(t.Button,{className:"sensei-number-control__button",isSmall:!0,isSecondary:!0,onClick:()=>m(null)},u||(0,r.__)("Reset","sensei-pro"))))},Ae=t=>{const n=(0,e.useMemo)((()=>Be()),[]);return(0,e.createElement)(xe,b({id:n,min:0,step:1},t,{suffix:(0,r._n)("Point","Points",t.value,"sensei-pro")}))},Se=t=>{let{options:{grade:n=1},setOptions:s}=t;return(0,e.createElement)(Ae,{label:(0,r.__)("Grade","sensei-pro"),value:n,onChange:e=>s({grade:null!=e?e:1}),allowReset:!0})},Pe={"multiple-choice":{title:(0,r.__)("Multiple Choice","sensei-pro"),description:(0,r.__)("Select from a list of options.","sensei-pro"),edit:be,view:be.view,settings:[n=>{let{options:{randomOrder:s=!1},setOptions:o}=n;return(0,e.createElement)(t.CheckboxControl,{label:(0,r.__)("Random Order","sensei-pro"),checked:s,onChange:e=>o({randomOrder:e})})}],feedback:!0,validate:function(){let{answers:e=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{noAnswers:e.filter((e=>e.label)).length<2,noRightAnswer:!e.some((e=>e.correct&&e.label)),noRightAnswerWhitespace:!e.some((e=>e.correct&&e.label.trim())),noWrongAnswer:!e.some((e=>!e.correct&&e.label)),noWrongAnswerWhitespace:!e.some((e=>!e.correct&&e.label.trim()))}},messages:{noAnswers:(0,r.__)("Add at least one right and one wrong answer.","sensei-pro"),noRightAnswer:(0,r.__)("Add a right answer to this question.","sensei-pro"),noRightAnswerWhitespace:(0,r.__)("The value of the right answer can not be blank space.","sensei-pro"),noWrongAnswer:(0,r.__)("Add a wrong answer to this question. Value can not be blank space.","sensei-pro"),noWrongAnswerWhitespace:(0,r.__)("The value of the wrong answer can not be blank space.","sensei-pro")}},boolean:{title:(0,r.__)("True/False","sensei-pro"),description:(0,r.__)("Select whether a statement is true or false.","sensei-pro"),edit:ke,view:ke.view,feedback:!0,settings:[]},"gap-fill":{title:(0,r.__)("Gap Fill","sensei-pro"),description:(0,r.__)("Fill in the blank.","sensei-pro"),edit:ie,view:ie.view,feedback:!0,settings:[],validate:function(){let{before:e,after:t,gap:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{noGap:!(null!=n&&n.filter((e=>""!==e)).length),noGapWhitespace:!(null!=n&&n.filter((e=>""!==e.trim())).length),noBeforeAndNoAfter:!e&&!t,noBeforeAndNoAfterWhitespace:!(null!=e&&e.trim()||null!=t&&t.trim())}},messages:{noGap:(0,r.__)("Add a right answer to this question.","sensei-pro"),noGapWhitespace:(0,r.__)("The value of a right answer can not be blank space.","sensei-pro"),noBeforeAndNoAfter:(0,r.__)("Add text before or after the gap. Value can not be blank space.","sensei-pro"),noBeforeAndNoAfterWhitespace:(0,r.__)("Value of the text before or after the gap can not be blank space.","sensei-pro")}},"single-line":{title:(0,r.__)("Single Line","sensei-pro"),description:(0,r.__)("Short answer to an open-ended question.","sensei-pro"),edit:we,view:we,settings:[fe]},"multi-line":{title:(0,r.__)("Multi Line","sensei-pro"),description:(0,r.__)("Long answer to an open-ended question.","sensei-pro"),edit:ue,view:ue,settings:[fe]},"file-upload":{title:(0,r.__)("File Upload","sensei-pro"),description:(0,r.__)("Upload a file or document.","sensei-pro"),edit:le,view:le,settings:[fe]}},Te={QuestionGradingNotesSettings:fe},Fe=(0,o.applyFilters)("sensei-lms.Question.questionTypes",Pe,Te),Oe=(0,l.createElement)(J.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,l.createElement)(J.Path,{d:"M12 3.2c-4.8 0-8.8 3.9-8.8 8.8 0 4.8 3.9 8.8 8.8 8.8 4.8 0 8.8-3.9 8.8-8.8 0-4.8-4-8.8-8.8-8.8zm0 16c-4 0-7.2-3.3-7.2-7.2C4.8 8 8 4.8 12 4.8s7.2 3.3 7.2 7.2c0 4-3.2 7.2-7.2 7.2zM11 17h2v-6h-2v6zm0-8h2V7h-2v2z"}));var ze,Ie;function Me(){return Me=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Me.apply(this,arguments)}const Re=function(e){return l.createElement("svg",Me({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},e),ze||(ze=l.createElement("path",{d:"M13 7h-2v6h2V7zm0 8h-2v2h2v-2z"})),Ie||(Ie=l.createElement("path",{d:"M12 4.75a7.25 7.25 0 100 14.5 7.25 7.25 0 000-14.5zM3.25 12a8.75 8.75 0 1117.5 0 8.75 8.75 0 01-17.5 0z"})))},Ve=()=>(0,e.createElement)("div",{className:"sensei-lms-question-block__notice"},(0,e.createElement)(K,{icon:Oe}),(0,e.createElement)(t.Tooltip,{text:(0,r.__)("Any updates made to this question will also update it in any other quiz that includes it.","sensei-pro")},(0,e.createElement)("span",null,(0,r.__)("Shared Question","sensei-pro")))),je=t=>{let{attributes:{type:n},meta:{validationErrors:s,showValidationErrors:r},getErrorMessages:o}=t;if(!r||null==s||!s.length)return null;const l=o(s,n);return(0,e.createElement)(De,{errors:l})},De=n=>{let{errors:s=[]}=n;if(!s||!s.length)return null;const r=s[0];return(0,e.createElement)(t.Notice,{isDismissible:!1,status:"warning",className:"sensei-lms-block-validation-notice"},(0,e.createElement)(Re,{className:"sensei-lms-block-validation-notice__icon"}),r)},Qe=n=>{let{value:s,onChange:r}=n;return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t.ToolbarGroup,{className:"sensei-lms-question-block__grade-toolbar"},(0,e.createElement)(t.ToolbarItem,{as:Ae,value:s,onChange:r})))},Le=(e,t)=>e.map((e=>{var n,s;return(null==Fe||null===(n=Fe[t])||void 0===n||null===(s=n.messages)||void 0===s?void 0:s[e])||rt.messages[e]})),Ge=()=>(0,e.createElement)(e.Fragment,null,(0,e.createElement)(g.BlockControls,null,(0,e.createElement)(t.Toolbar,null,(0,e.createElement)(t.ToolbarButton,{disabled:!0},(0,r.__)("Locked","sensei-pro")))),(0,e.createElement)(g.InspectorControls,null,(0,e.createElement)(t.PanelBody,{title:(0,r.__)("Question Details","sensei-pro"),initialOpen:!0},(0,e.createElement)("div",null,(0,r.__)("You are not allowed to edit this question.","sensei-pro"))))),We=t=>{let{clientId:n,attributes:{title:s,answer:r,editable:o},questionIndex:l,questionGrade:a,AnswerBlock:i}=t;const c=(0,u.useSelect)((e=>e("core/block-editor").getBlock(n)),[n]);return(0,e.createElement)("div",{className:"sensei-lms-question-block"},l,(0,e.createElement)("h2",{className:"sensei-lms-question-block__title"},s),a,(0,e.createElement)(e.RawHTML,null,(0,h.getBlockContent)(c)),(null==i?void 0:i.view)&&(0,e.createElement)(i.view,{attributes:r}),!o&&(0,e.createElement)(Ge,null))},He=n=>{let{controls:s=[],attributes:{options:o={}},setAttributes:l,...a}=n;const i=e=>l({options:{...o,...e}});return(0,e.createElement)(g.InspectorControls,null,(0,e.createElement)(t.PanelBody,{title:(0,r.__)("Question settings","sensei-pro"),initialOpen:!0},[Se,...s].map((t=>(0,e.createElement)(t,b({key:t},a,{options:o,setOptions:i})))),(0,e.createElement)(t.ToggleControl,{label:(0,r.__)("Hide Answer Feedback","sensei-pro"),checked:"yes"===o.hideAnswerFeedback,onChange:e=>i({hideAnswerFeedback:e?"yes":""}),help:(0,r.__)("Do not show any feedback when the student answers this question.","sensei-pro")})))},Ue=n=>{let{options:s,optionsLabel:r,icon:o,value:l,onChange:a,toggleProps:i,getMenuItemProps:c,popoverProps:u,...m}=n;const p=s.find((e=>l===e.value));return(0,e.createElement)(t.ToolbarDropdownMenu,b({className:"sensei-toolbar-dropdown",popoverProps:{variant:"toolbar",position:"bottom right left",focusOnMount:!0,...u,className:f()(null==u?void 0:u.className,"sensei-toolbar-dropdown__popover")},label:r,icon:null!=o?o:null,text:null!=i&&i.children?i.children(p):null==p?void 0:p.label},m),(n=>{let{onClose:o}=n;return(0,e.createElement)(t.MenuGroup,{label:r},s.map((n=>{const s=n.value===(null==p?void 0:p.value),r=null==c?void 0:c(n);return(0,e.createElement)(t.MenuItem,b({key:n.value,role:"menuitemradio",isSelected:s,icon:s?me:null,className:f()("sensei-toolbar-dropdown__option",{"is-selected":s},null==r?void 0:r.className),onClick:()=>{a(n.value),o()},children:n.label},r))})))}))},Ke=n=>{let{value:s,onSelect:l,options:a}=n;return(0,e.createElement)(t.ToolbarGroup,{className:"sensei-lms-question-block__type-selector__toolbar"},(0,e.createElement)(Ue,{className:"sensei-lms-question-block__type-selector",label:(0,r.__)("Question Type","sensei-pro"),options:a,value:s,onChange:e=>l(e),optionsLabel:(0,r.__)("Question Type","sensei-pro"),popoverProps:{className:"sensei-lms-question-block__type-selector__popover"},toggleProps:{children:t=>(0,e.createElement)("b",null,null==t?void 0:t.title)},getMenuItemProps:t=>{let n=(0,e.createElement)("div",null,(0,e.createElement)("strong",null," ",t.title),(0,e.createElement)("div",{className:"sensei-lms-question-block__type-selector__option__description"},t.description));n=(0,o.applyFilters)("senseiQuestionTypeToolbarOptionChildren",n,t);const s={};return s.children=n,t.disabled&&(s.onClick=()=>{}),s}}))},Je=window.wp.editPost,$e=window.wp.editor,Xe=$e.PluginPostStatusInfo||Je.PluginPostStatusInfo,Ye=$e.PluginPrePublishPanel||Je.PluginPrePublishPanel,Ze=n=>{const{meta:{validationErrors:s,showValidationErrors:o},setMeta:l}=n,a=(0,e.useCallback)((function(){l({showValidationErrors:!(arguments.length>0&&void 0!==arguments[0])||arguments[0]})}),[l]);if(function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const s=(0,u.useSelect)((e=>e("core/editor").isSavingPost()&&!e("core/editor").isAutosavingPost()));(0,e.useEffect)((()=>{s&&t()}),[s,...n])}((()=>a(!1)),[a]),null==s||!s.length)return null;const i=(0,e.createElement)(t.Notice,{isDismissible:!1,status:"warning",className:"sensei-lms-quiz-block__pre-publish-validation__notice",actions:o?[]:[{label:(0,r.__)("View issues","sensei-pro"),onClick:()=>a(!0),className:"is-link"}]},(0,r.__)("This question is incomplete.","sensei-pro"));return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(Xe,null,i),(0,e.createElement)(Ye,{title:(0,r.__)("Validation","sensei-pro"),initialOpen:!0},(0,e.createElement)(oe,{onMount:a}),i,(0,e.createElement)("p",null,(0,r.__)("Incomplete questions added to a quiz won't be displayed to the student.","sensei-pro"))))};let et=Object.entries(Fe).map((e=>{let[t,n]=e;return{...n,label:n.title,value:t}}));et=(0,o.applyFilters)("senseiQuestionTypeToolbarOptions",et);const tt=(0,s.compose)(G,w((e=>{var t;const{id:n,type:s,title:r,answer:o}=e,l=s&&Fe[s],a=(null===(t=l.validate)||void 0===t?void 0:t.call(l,o))||{},i=null==r?void 0:r.length;return i||o||n?{noTitle:!i,...a}:{}})))((t=>{var n;const{attributes:{title:s,type:o,answer:l={},options:a,shared:i,editable:c=!0},setAttributes:m,clientId:p,context:d}=t,{removeBlock:_,selectBlock:h}=(0,u.useDispatch)("core/block-editor"),w=(0,e.useCallback)((()=>{const e=(0,u.select)("core/block-editor").getBlocks(p);e.length&&h(e[0].clientId)}),[p,h]),v=te(p),k=o&&Fe[o],y=null==k?void 0:k.feedback,q=(e=>{let{isSelected:t,clientId:n}=e;return(0,u.useSelect)((e=>e("core/block-editor").hasSelectedInnerBlock(n,!0)),[n])||t})(t),N=d&&!("sensei-lms/quizId"in d),C=s||q||N,B=!N&&(0,e.createElement)("h2",{className:"sensei-lms-question-block__index"},v,"."),x=t.meta.showValidationErrors&&(null===(n=t.meta.validationErrors)||void 0===n?void 0:n.length),A=(0,e.createElement)("div",{className:"sensei-lms-question-block__grade grade"},(T=a.grade,// Translators: placeholder is the grade for the questions.
// Translators: placeholder is the grade for the questions.
(0,r.sprintf)((0,r._n)("%d point","%d points",T,"sensei-pro"),T)));var T;const[F,O]=(0,e.useState)(!1),z=(0,e.useMemo)((()=>({answer:l,setAttributes:m,AnswerBlock:k,hasSelected:q,canHaveFeedback:y,answerFeedback:{showAnswerFeedback:F,toggleAnswerFeedback:O},options:a})),[k,l,q,m,F,y,a]),I=(0,e.useMemo)((()=>[[U.name,{}],[ee.name,{}],...y?[[S.name,{}],[P.name,{}]]:[]]),[y]),M=(0,g.useBlockProps)({className:f()("sensei-lms-question-block",{"is-draft":!s,"is-invalid":x,"show-answer-feedback":F})});return c?(0,e.createElement)("div",M,(0,e.createElement)("div",{className:"sensei-lms-question-block__header"},B,N&&(0,e.createElement)(Ze,t),(0,e.createElement)("h2",{className:"sensei-lms-question-block__title"},(0,e.createElement)(re,{placeholder:(0,r.__)("Question Title","sensei-pro"),value:s,onChange:e=>m({title:e}),onEnter:w,onRemove:()=>_(p)})),k.subtitle&&(0,e.createElement)(k.subtitle,{isQuestionSelected:q}),C&&A),q&&i&&(0,e.createElement)(Ve,null),C&&(0,e.createElement)(E.Provider,{value:z},(0,e.createElement)(g.InnerBlocks,{template:I,templateInsertUpdatesSelection:!1,templateLock:"all",renderAppender:null})),(0,e.createElement)(je,b({},t,{getErrorMessages:Le})),(0,e.createElement)(g.BlockControls,null,(0,e.createElement)(Ke,{value:o,onSelect:e=>m({type:e}),options:et}),(0,e.createElement)(Qe,{value:a.grade,onChange:e=>m({options:{...a,grade:e}})})),(0,e.createElement)(He,b({controls:null==k?void 0:k.settings},t))):(0,e.createElement)(We,b({},t,{questionGrade:A,questionIndex:B,AnswerBlock:k}))})),nt=JSON.parse('{"name":"sensei-lms/quiz-question","title":"Question","apiVersion":2,"description":"The building block of all quizzes.","parent":["sensei-lms/quiz"],"category":"sensei-lms","textdomain":"sensei-lms","supports":{"html":false},"example":{"attributes":{"title":"What are power chords?","answer":{"answers":[{"label":"  A chord consisting of a root note of the chord and a 5th","correct":true},{"label":"  A chord playing on an electric guitar","correct":false}]}}},"attributes":{"id":{"type":"integer"},"title":{"type":"string"},"type":{"type":"string","default":"multiple-choice"},"answer":{"type":"object"},"options":{"type":"object","default":{"grade":1,"hideAnswerFeedback":""}},"editable":{"type":"boolean","default":true,"source":false}}}'),st=[{onProgrammaticCreation:!0,isEligible(e,t){var n;let s=!0;return null!==(n=e.options)&&void 0!==n&&n.answerFeedback&&(s=!0),t.map((e=>([U.name,S.name,P.name].includes(e.name)&&(s=!1),!0))),s},attributes:{...nt.attributes},migrate(e,t){var n;const s=[];return s.push((0,h.createBlock)(U.name,{},t),(0,h.createBlock)(ee.name,{})),null!==(n=e.options)&&void 0!==n&&n.answerFeedback&&(s.push((0,h.createBlock)(S.name,{},[(0,h.createBlock)("core/paragraph",{content:e.options.answerFeedback})])),s.push((0,h.createBlock)(P.name,{},[(0,h.createBlock)("core/paragraph",{content:e.options.answerFeedback})]))),[{...e,options:(0,T.omit)(e.options,"answerFeedback")},s]},save:()=>(0,e.createElement)(g.InnerBlocks.Content,null)},{onProgrammaticCreation:!0,isEligible(e){var t;return e.media||"file-upload"===e.type&&!(null===(t=e.options)||void 0===t||!t.studentHelp)},attributes:{...nt.attributes,media:{type:"object"}},migrate(t,n){var s;const r=[...n];return t.media&&r.push((t=>{switch(t.type){case"image":return(0,h.createBlock)("core/image",{id:t.id,url:t.url});case"audio":return(0,h.createBlock)("core/audio",{id:t.id,src:t.url});case"video":return(0,h.createBlock)("core/video",{id:t.id,src:t.url});default:const n=(0,e.createElement)("a",{href:t.url},t.title);return(0,h.createBlock)("core/paragraph",{content:(0,e.renderToString)(n)})}})(t.media)),"file-upload"===t.type&&null!==(s=t.options)&&void 0!==s&&s.studentHelp&&r.push((0,h.createBlock)("core/paragraph",{content:t.options.studentHelp})),[{...(0,T.omit)(t,"media"),options:(0,T.omit)(t.options,"studentHelp")},r]},save:()=>(0,e.createElement)(g.InnerBlocks.Content,null)}],rt={...nt,metadata:nt,icon:x,usesContext:["sensei-lms/quizId"],deprecated:st,edit:tt,save:()=>(0,e.createElement)(g.InnerBlocks.Content,null),messages:{noTitle:(0,r.__)("Add a title to this question.","sensei-pro")}},ot=()=>{const t=(0,u.useSelect)((e=>{const t=e("core").getEntityRecords("taxonomy","question-category",{per_page:-1});return null!=t?t:[]}),[]),n=(0,e.useMemo)((()=>(t||[]).map((e=>({...e,name:unescape(e.name)})))),[t]),s=(0,e.useMemo)((()=>(0,T.keyBy)(null!=n?n:[],"id")),[n]);return[n,e=>{var t;return!(!s||0===s.length)&&null!==(t=s[e])&&void 0!==t&&t}]},lt=n=>{var s,o;let{attributes:{options:l={}},setAttributes:a}=n;const i=function(e){return a({...arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},options:{...l,...e}})},[c,u]=ot(),[m,p]=(0,e.useState)(null),d=((t,n)=>{const[s,r]=(0,e.useState)({});return(0,e.useEffect)((()=>{t&&!s.hasOwnProperty(t)&&_()({path:`/wp/v2/questions?question-category=${t}`,method:"GET",parse:!1}).then((e=>{s[t]=+e.headers.get("X-WP-Total"),r({...s})})).catch((e=>{e.json().then((e=>n(e.message)))}))}),[t,s,n]),!!s.hasOwnProperty(t)&&s[t]})(l.category,p),h=[{value:"",label:""},...(c||[]).map((e=>({value:e.id,label:e.name})))];return(0,e.createElement)(g.InspectorControls,null,(0,e.createElement)(t.PanelBody,{title:(0,r.__)("Category Question Settings","sensei-pro"),initialOpen:!0},!h.length&&(0,e.createElement)(t.Notice,{status:"warning",isDismissible:!1},(0,r.__)("No question categories exist.","sensei-pro")),h.length>0&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t.SelectControl,{label:(0,r.__)("Category","sensei-pro"),options:h,value:null!==(s=l.category)&&void 0!==s?s:"",onChange:e=>{var t;const n=u(+e);i({category:null!==(t=+e)&&void 0!==t?t:null},{categoryName:null==n?void 0:n.name}),p(null)}}),(0,e.createElement)(xe,{label:(0,r.__)("Number of Questions","sensei-pro"),min:1,step:1,value:null!==(o=l.number)&&void 0!==o?o:1,onChange:e=>e&&i({number:e||1})}),null!==m&&(0,e.createElement)(t.Notice,{status:"error",isDismissible:!1},(0,r.sprintf)(// translators: The underlying error message.
// translators: The underlying error message.
(0,r.__)("An error occurred while retrieving questions: %s","sensei-pro"),m)),!1!==d&&null===m&&l.number>d&&(0,e.createElement)(t.Notice,{status:"warning",isDismissible:!1},(0,r.sprintf)(// translators: Placeholder is number of questions in category.
// translators: Placeholder is number of questions in category.
(0,r._n)("The selected category has %d question.","The selected category has %d questions.",d,"sensei-pro"),d)))))},at=e=>e.map((e=>ut.messages[e])),it=(0,s.compose)(G,w((e=>{const{options:t}=e;return{noCategory:!((null==t?void 0:t.category)>0)}})))((t=>{var n,s;const{attributes:{options:{number:o=1,category:l}},clientId:a,setAttributes:i}=t,c=te(a),[,u]=ot(),m=o&&1!==o?`${c} - ${c+o-1}`:c,p=(0,e.createElement)("h2",{className:"sensei-lms-question-block__index"},m,"."),d=null!==(n=null===(s=u(l))||void 0===s?void 0:s.name)&&void 0!==n?n:t.attributes.categoryName,_=d===t.attributes.categoryName;return(0,e.useEffect)((()=>{d&&!_&&i({categoryName:d})}),[d,_,i]),(0,e.createElement)(e.Fragment,null,(0,e.createElement)(lt,t),(0,e.createElement)("div",{className:"sensei-lms-question-block sensei-lms-category-question-block "+(l?"":"is-draft")},p,(0,e.createElement)("h2",{className:"sensei-lms-question-block__title"},d?(0,e.createElement)("strong",null,d):(0,r.__)("Category Question","sensei-pro"),d&&o>0&&" ("+(0,r.sprintf)(// translators: placeholder is number of questions to show from category.
// translators: placeholder is number of questions to show from category.
(0,r._n)("%d question","%d questions",o,"sensei-pro"),o)+")")),(0,e.createElement)(je,b({},t,{getErrorMessages:at})))})),ct=JSON.parse('{"name":"sensei-lms/quiz-category-question","title":"Category Question","description":"Pull questions from a question category.","parent":["sensei-lms/quiz"],"category":"sensei-lms","textdomain":"sensei-lms","supports":{"html":false},"attributes":{"id":{"type":"integer"},"type":{"type":"string","default":"category-question"},"categoryName":{"type":"string"},"options":{"type":"object","default":{"category":null,"number":1}}}}'),ut={...ct,metadata:ct,icon:x,usesContext:["sensei-lms/quizId"],example:{attributes:{categoryName:(0,r.__)("Example Category","sensei-pro")}},edit:it,save:()=>(0,e.createElement)(g.InnerBlocks.Content,null),messages:{noCategory:(0,r.__)("Assign a category to this question.","sensei-pro")}},mt=e=>{const t=e.length&&e[e.length-1];return!t||("category-question"===(n=t.attributes).type?n.options.category:n.title)?e.length:e.length-1;var n},pt=()=>{const{insertBlock:t,updateBlockAttributes:n}=(0,u.useDispatch)("core/block-editor"),[s,o]=(0,e.useState)(!1),[l,a]=(0,e.useState)(null),[i,c]=(0,e.useState)(3),{createErrorNotice:m}=(0,u.useDispatch)("core/notices"),[p,d]=(0,e.useState)(!1),[g,b]=(0,e.useState)(""),[w,v]=(0,e.useState)(!1),k=(0,u.useSelect)((e=>{const t=e("sensei/quiz-structure").getBlock();return e("core/block-editor").getBlock(t)}),[]);return(0,e.useEffect)((()=>{k&&mt(k.innerBlocks)>0!==p&&d(!p)})),(0,e.useEffect)((()=>{l&&i&&(async()=>{o(!0);try{let e=await(async(e,t)=>_()({method:"POST",path:"/sensei-pro-ai/v1/gpt/questions",parse:!1,data:{text:e,count:t}}))(l,i);if(e=await e.json(),!e||!e.questions)throw new Error((0,r.__)("Unexpected error. Try again later.","sensei-pro"));const s=e.questions;let o=mt(k.innerBlocks);s&&s.forEach((e=>{((e,t,n,s,r)=>{const o=(0,h.createBlock)(rt.name,{title:e.question,answer:{answers:e.answers.map(((t,n)=>({label:t,correct:n===e.correct_answer_index})))}});n(o,t,s,!0),((e,t,n,s,r)=>{setTimeout((async()=>{(0,u.select)("core/block-editor").getBlocks(s).forEach((n=>{["sensei-lms/quiz-question-feedback-correct","sensei-lms/quiz-question-feedback-incorrect"].includes(n.name)&&r(n.innerBlocks[0].clientId,{content:"sensei-lms/quiz-question-feedback-correct"===n.name?e:t})}))}),0)})(e.correct_answer_explanation,e.nudge_towards_correct_answer,0,o.clientId,r)})(e,o++,t,k.clientId,n)}))}catch(e){dt(e,m,b,v)}finally{o(!1),a(null)}})()}),[l,i]),{isBusy:s,generateQuizQuestions:(e,t)=>{a(e),c(t)},limitErrorMessage:g,disabledByTimeout:w,hasQuestions:p}},dt=async(e,t,n,s)=>{if(e.status&&429===e.status)return n(await e.json()),s(!0),void setTimeout((()=>{s(!1)}),3e5);const o=(0,r.__)("Sorry could not generate questions","sensei-pro");let l=null;e instanceof Error?l=e.message:e instanceof Response&&(l=await e.json()),l&&l.message&&(l=l.message),t(l||o,{type:"snackbar"})},_t={lessonNoContent:(0,r.__)("Oops! Looks like your lesson doesn't have any content. Quiz questions are generated based on the current content of the lesson.","sensei-pro")},ht=n=>s=>{const{isBusy:o,generateQuizQuestions:l,limitErrorMessage:a,disabledByTimeout:i,hasQuestions:p}=pt(),[d,_]=(0,e.useState)(null),[h,g]=(0,e.useState)(!1);return(0,e.useEffect)((()=>{g(i),i&&_(a)}),[i,a]),(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t.Fill,{name:"SenseiQuizHeader"},(0,e.createElement)(t.Button,{variant:"secondary",onClick:()=>{const e=m((0,u.select)("core/block-editor").getBlocks().filter((e=>"sensei-lms/quiz"!==e.name))).trim();if(!e)return _(_t.lessonNoContent),void g(!0);d===_t.lessonNoContent&&(_(null),g(!1)),l(e,3)},className:"sensei-pro-ai-generate-questions-button",disabled:o||p||i},(0,e.createElement)("div",{className:"button-text-content"},(0,e.createElement)(c,null),(0,r.__)("Generate quiz questions with AI","sensei-pro")))),o&&(0,e.createElement)(t.Fill,{name:"SenseiQuizBlockTop"},(0,e.createElement)("div",{className:"sensei-pro-quiz-question-generate-loader"},(0,e.createElement)(t.Spinner,null))),h&&(0,e.createElement)(t.Fill,{name:"SenseiQuizBlockTop"},(0,e.createElement)("div",{className:"sensei-message info"},d)),(0,e.createElement)(n,s))};(0,o.addFilter)("blocks.registerBlockType","sensei-lms/with-chat-gpt-question-generator",(e=>"sensei-lms/quiz"!==e.name?e:{...e,edit:(0,s.compose)(ht)(e.edit)}))})()})();